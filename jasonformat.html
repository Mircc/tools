<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSON æ ¼å¼åŒ–å·¥å…·</title>
    <meta name="description" content="ç”¨äºæ ¼å¼åŒ–ã€éªŒè¯å’Œç¾åŒ– JSON æ•°æ®ï¼Œæ”¯æŒå®æ—¶æ¸²æŸ“å’Œæ ‘å½¢è§†å›¾ã€‚">
    
    <style>
        :root {
            --primary: #2563eb;
            --primary-hover: #1d4ed8;
            --bg: #f8fafc;
            --card: #ffffff;
            --border: #e2e8f0;
            --text-main: #1e293b;
            --text-sub: #64748b;
            --success: #10b981;
            --danger: #ef4444;
            --radius: 12px;
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: var(--bg);
            color: var(--text-main);
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }

        .container { max-width: 1000px; margin: 0 auto; }
        
        h1 { color: var(--text-main); text-align: center; margin-bottom: 5px; font-size: 2rem; }
        .description { text-align: center; color: var(--text-sub); margin-bottom: 30px; font-size: 1rem; }

        .card {
            background: var(--card);
            padding: 30px;
            border-radius: var(--radius);
            box-shadow: var(--shadow-lg);
            margin-bottom: 20px;
        }
        
        /* Layout Grid */
        .json-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
        }
        @media (min-width: 768px) {
            .json-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        /* Input & Textarea Styles */
        .input-group { width: 100%; }
        label { display: block; font-weight: 600; font-size: 0.9em; margin-bottom: 8px; color: var(--text-sub); }

        textarea {
            width: 100%; min-height: 400px; padding: 15px; border: 1px solid var(--border); border-radius: 8px;
            font-size: 14px; box-sizing: border-box; background: #fff; color: var(--text-main);
            font-family: monospace; resize: vertical; outline: none;
            transition: border-color 0.2s, box-shadow 0.2s;
        }
        textarea:focus { border-color: var(--primary); box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1); }
        textarea[readonly] { background: #f1f5f9; cursor: text; }

        /* Controls */
        .controls-bar {
            display: flex;
            justify-content: flex-start;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .btn { padding: 10px 20px; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.2s; }
        .btn-primary { background: var(--primary); color: white; }
        .btn-primary:hover { background: var(--primary-hover); }
        .btn-secondary { background: #6b7280; color: white; }
        .btn-danger { background: var(--danger); color: white; }

        /* Status */
        .status-message {
            margin-top: 15px;
            padding: 10px;
            border-radius: 8px;
            font-weight: 600;
            display: none;
            font-size: 0.95rem;
        }
        .status-valid { background: var(--success); color: white; }
        .status-error { background: var(--danger); color: white; }

    </style>
</head>
<body>

<div class="container">
    <div class="header-section">
        <h1>JSON æ ¼å¼åŒ–å·¥å…·</h1>
        <p class="description">ç”¨äºæ ¼å¼åŒ–ã€éªŒè¯å’Œç¾åŒ– JSON æ•°æ®ï¼Œæ”¯æŒå®æ—¶æ¸²æŸ“å’Œæ ‘å½¢è§†å›¾ã€‚</p>
    </div>

    <div class="card">
        <div class="controls-bar">
            <button class="btn btn-primary" id="formatBtn">âœ¨ æ ¼å¼åŒ– / ç¾åŒ–</button>
            <button class="btn btn-secondary" id="minifyBtn">â†”ï¸ å‹ç¼© / Minify</button>
            <button class="btn btn-danger" id="clearBtn">ğŸ—‘ï¸ æ¸…ç©º</button>
        </div>

        <div id="statusOutput" class="status-message"></div>

        <div class="json-grid">
            <div class="input-group">
                <label for="inputJson">JSON è¾“å…¥ (æ”¯æŒç²˜è´´æˆ–æ‰‹åŠ¨ç¼–è¾‘)</label>
                <textarea id="inputJson" placeholder="ç²˜è´´ JSON å­—ç¬¦ä¸²åˆ°æ­¤å¤„..."></textarea>
            </div>

            <div class="input-group">
                <label for="outputJson">JSON è¾“å‡º / ç»“æœ</label>
                <textarea id="outputJson" readonly placeholder="æ ¼å¼åŒ–æˆ–å‹ç¼©åçš„ JSON æ•°æ®å°†åœ¨æ­¤æ˜¾ç¤º..."></textarea>
            </div>
        </div>
    </div>
</div>

<script>
    // --- DOM å…ƒç´  ---
    const inputJson = document.getElementById('inputJson');
    const outputJson = document.getElementById('outputJson');
    const formatBtn = document.getElementById('formatBtn');
    const minifyBtn = document.getElementById('minifyBtn');
    const clearBtn = document.getElementById('clearBtn');
    const statusOutput = document.getElementById('statusOutput');

    // --- æ ¸å¿ƒé€»è¾‘ ---

    function showStatus(message, isError = false) {
        statusOutput.textContent = message;
        statusOutput.style.display = 'block';
        statusOutput.classList.remove('status-valid', 'status-error');
        statusOutput.classList.add(isError ? 'status-error' : 'status-valid');
    }

    function validateAndParse(jsonString) {
        try {
            const data = JSON.parse(jsonString);
            showStatus('âœ… JSON éªŒè¯é€šè¿‡ï¼', false);
            return data;
        } catch (e) {
            showStatus('âŒ JSON æ ¼å¼é”™è¯¯ï¼è¯·æ£€æŸ¥è¯­æ³• (ä¾‹å¦‚ï¼šç¼ºå¤±é€—å·æˆ–å¼•å·)ã€‚', true);
            throw e; // æŠ›å‡ºé”™è¯¯ä»¥åœæ­¢åç»­å¤„ç†
        }
    }

    function formatJson() {
        const jsonString = inputJson.value.trim();
        if (!jsonString) {
            outputJson.value = '';
            showStatus('âš ï¸ è¾“å…¥å†…å®¹ä¸ºç©ºã€‚', true);
            return;
        }

        try {
            const data = validateAndParse(jsonString);
            // æ ¼å¼åŒ–ï¼šä½¿ç”¨ null, 2 ç¼©è¿›
            outputJson.value = JSON.stringify(data, null, 2);
        } catch (e) {
            outputJson.value = "æ— æ³•æ ¼å¼åŒ–ï¼Œè¯·ä¿®æ­£ JSON é”™è¯¯ã€‚";
        }
    }

    function minifyJson() {
        const jsonString = inputJson.value.trim();
        if (!jsonString) {
            outputJson.value = '';
            showStatus('âš ï¸ è¾“å…¥å†…å®¹ä¸ºç©ºã€‚', true);
            return;
        }

        try {
            const data = validateAndParse(jsonString);
            // å‹ç¼©ï¼šä½¿ç”¨ null, 0 ç¼©è¿› (æˆ–ä¸ä¼ å‚æ•°)
            outputJson.value = JSON.stringify(data);
            showStatus('âœ… JSON éªŒè¯é€šè¿‡å¹¶å·²å‹ç¼©ï¼', false);
        } catch (e) {
            outputJson.value = "æ— æ³•å‹ç¼©ï¼Œè¯·ä¿®æ­£ JSON é”™è¯¯ã€‚";
        }
    }

    function clearContent() {
        inputJson.value = '';
        outputJson.value = '';
        statusOutput.style.display = 'none';
    }

    // --- åˆå§‹åŒ–å’Œäº‹ä»¶ç»‘å®š ---

    window.onload = function() {
        // ç»‘å®šæŒ‰é’®äº‹ä»¶
        formatBtn.addEventListener('click', formatJson);
        minifyBtn.addEventListener('click', minifyJson);
        clearBtn.addEventListener('click', clearContent);

        // ç»‘å®šå›è½¦é”®ï¼šåœ¨è¾“å…¥æ¡†å†…æŒ‰ Ctrl + Enter è§¦å‘æ ¼å¼åŒ–
        inputJson.addEventListener('keydown', function(e) {
            if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
                e.preventDefault();
                formatJson();
            }
        });
        
        // ç»‘å®šè¾“å…¥äº‹ä»¶ï¼šè¾“å…¥å†…å®¹å˜åŒ–æ—¶è¿›è¡Œå®æ—¶éªŒè¯
        inputJson.addEventListener('input', function() {
            const val = this.value.trim();
            if (val) {
                // ä»…åœ¨è¾“å…¥ä¸ä¸ºç©ºæ—¶å°è¯•éªŒè¯ï¼Œä½†ä¸åœ¨è¾“å‡ºæ¡†æ˜¾ç¤ºæ ¼å¼åŒ–ç»“æœ
                try {
                    JSON.parse(val);
                    showStatus('âœ… JSON æ ¼å¼æœ‰æ•ˆã€‚', false);
                } catch (e) {
                    showStatus('âŒ JSON æ ¼å¼æœ‰è¯¯ï¼Œè¯·æ£€æŸ¥è¯­æ³•ã€‚', true);
                }
            } else {
                 statusOutput.style.display = 'none';
            }
        });
        
        // åŒå‡»å¤åˆ¶åŠŸèƒ½ (åº”ç”¨äºè¾“å‡ºæ¡†)
        outputJson.addEventListener('dblclick', function() {
            outputJson.select();
            document.execCommand('copy');
            showStatus('ğŸ“‹ ç»“æœå·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼', false);
            // å»¶è¿Ÿæ¸…ç©ºçŠ¶æ€ä¿¡æ¯
            setTimeout(() => statusOutput.style.display = 'none', 1500);
        });
    };
</script>

</body>
</html>
